const url="https://parallelum.com.br/fipe/api/v1",vehicle={type:"",brand:"",model:"",year:""};let i=0,j=0,k=0;const brandLabel=document.getElementById("brand-label"),brandSelect=document.getElementById("brand-select"),modelLabel=document.getElementById("model-label"),modelSelect=document.getElementById("model-select"),yearLabel=document.getElementById("year-label"),yearSelect=document.getElementById("year-select"),submitButton=document.getElementById("submit-button"),vehicleForm=document.getElementById("vehicle-form"),resultArea=document.getElementById("result-area"),loadingElement=document.getElementById("loading-element");let loading=!1;async function choiceVehicle(e){vehicle.type=e,loading=!0,loadingControl(),createBrandList(await fetch(`${url}/${vehicle.type}/marcas`).then(e=>e.json()))}function createBrandList(e){for(brandLabel.classList.remove("hidden-element"),brandSelect.classList.remove("hidden-element"),brandLabel.classList.add("shown-element"),brandSelect.classList.add("shown-element"),autoScroll(),i=0;i<e.length;i++)brandSelect.innerHTML+=`<option value="${e[i].codigo}">${e[i].nome}</option>`;loading=!1,loadingControl()}async function listModels(){loading=!0,loadingControl(),createModelList(await fetch(`${url}/${vehicle.type}/marcas/${vehicle.brand}/modelos`).then(e=>e.json()))}function createModelList(e){for(modelLabel.classList.remove("hidden-element"),modelSelect.classList.remove("hidden-element"),modelLabel.classList.add("shown-element"),modelSelect.classList.add("shown-element"),autoScroll(),j=0;j<e.modelos.length;j++)modelSelect.innerHTML+=`<option value="${e.modelos[j].codigo}">${e.modelos[j].nome}</option>`;loading=!1,loadingControl()}async function listYears(){loading=!0,loadingControl(),createYearList(await fetch(`${url}/${vehicle.type}/marcas/${vehicle.brand}/modelos/${vehicle.model}/anos`).then(e=>e.json()))}function createYearList(e){for(yearLabel.classList.remove("hidden-element"),yearSelect.classList.remove("hidden-element"),yearLabel.classList.add("shown-element"),yearSelect.classList.add("shown-element"),autoScroll(),k=0;k<e.length;k++)yearSelect.innerHTML+=`<option value="${e[k].codigo}">${e[k].nome}</option>`;loading=!1,loadingControl()}function showResult(e){resultArea.classList.remove("hidden-element"),resultArea.classList.add("shown-element"),resultArea.innerHTML=`<h5>Pela tabela FIPE, seu veículo ${e.Marca} - ${e.Modelo} - ${e.AnoModelo}, vale em média:</h5><h2>${e.Valor}</h2><h6>Consulta válida para ${e.MesReferencia}</h6><h6>Código FIPE: ${e.CodigoFipe}</h6>`,loading=!1,loadingControl(),autoScroll()}function autoScroll(){const e=document.body.scrollHeight;window.scrollTo(0,e)}function loadingControl(){loading?(loadingElement.classList.remove("hidden-element"),loadingElement.classList.add("shown-element")):(loadingElement.classList.remove("shown-element"),loadingElement.classList.add("hidden-element")),autoScroll()}brandSelect.addEventListener("change",function(){vehicle.brand=brandSelect.value,listModels()}),modelSelect.addEventListener("change",function(){vehicle.model=modelSelect.value,listYears()}),yearSelect.addEventListener("change",function(){vehicle.year=yearSelect.value,submitButton.classList.remove("hidden-element"),submitButton.classList.add("shown-element"),autoScroll()}),vehicleForm.addEventListener("submit",async function(e){e.preventDefault(),loading=!0,loadingControl(),showResult(await fetch(`${url}/${vehicle.type}/marcas/${vehicle.brand}/modelos/${vehicle.model}/anos/${vehicle.year}`).then(e=>e.json()))});
