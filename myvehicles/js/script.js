const url="https://parallelum.com.br/fipe/api/v1";const vehicle={type:'',brand:'',model:'',year:''};let i=0;let j=0;let k=0;const brandLabel=document.getElementById("brand-label");const brandSelect=document.getElementById("brand-select");const modelLabel=document.getElementById("model-label");const modelSelect=document.getElementById("model-select");const yearLabel=document.getElementById("year-label");const yearSelect=document.getElementById("year-select");const submitButton=document.getElementById("submit-button");const vehicleForm=document.getElementById("vehicle-form");const resultArea=document.getElementById("result-area");const loadingElement=document.getElementById("loading-element");let loading=false;async function choiceVehicle(choice){vehicle.type=choice;loading=true;loadingControl();const vehiclesBrands=await fetch(`${url}/${vehicle.type}/marcas`).then(data=>data.json());createBrandList(vehiclesBrands);} function createBrandList(brandsList){brandLabel.classList.remove("hidden-element");brandSelect.classList.remove("hidden-element");brandLabel.classList.add("shown-element");brandSelect.classList.add("shown-element");autoScroll();for(i=0;i<brandsList.length;i++){brandSelect.innerHTML+=`<option value="${brandsList[i].codigo}">${brandsList[i].nome}</option>`} loading=false;loadingControl();} brandSelect.addEventListener("change",function(){vehicle.brand=brandSelect.value;listModels();}) async function listModels(){loading=true;loadingControl();const vehiclesModels=await fetch(`${url}/${vehicle.type}/marcas/${vehicle.brand}/modelos`).then(data=>data.json());createModelList(vehiclesModels);} function createModelList(modelsList){modelLabel.classList.remove("hidden-element");modelSelect.classList.remove("hidden-element");modelLabel.classList.add("shown-element");modelSelect.classList.add("shown-element");autoScroll();for(j=0;j<modelsList.modelos.length;j++){modelSelect.innerHTML+=`<option value="${modelsList.modelos[j].codigo}">${modelsList.modelos[j].nome}</option>`} loading=false;loadingControl();} modelSelect.addEventListener("change",function(){vehicle.model=modelSelect.value;listYears();}) async function listYears(){loading=true;loadingControl();const vehicleYears=await fetch(`${url}/${vehicle.type}/marcas/${vehicle.brand}/modelos/${vehicle.model}/anos`).then(data=>data.json());createYearList(vehicleYears);} function createYearList(yearsList){yearLabel.classList.remove("hidden-element");yearSelect.classList.remove("hidden-element");yearLabel.classList.add("shown-element");yearSelect.classList.add("shown-element");autoScroll();for(k=0;k<yearsList.length;k++){yearSelect.innerHTML+=`<option value="${yearsList[k].codigo}">${yearsList[k].nome}</option>`} loading=false;loadingControl();} yearSelect.addEventListener("change",function(){vehicle.year=yearSelect.value;submitButton.classList.remove("hidden-element");submitButton.classList.add("shown-element");autoScroll();}) vehicleForm.addEventListener('submit',async function(event){event.preventDefault();loading=true;loadingControl();const result=await fetch(`${url}/${vehicle.type}/marcas/${vehicle.brand}/modelos/${vehicle.model}/anos/${vehicle.year}`).then(data=>data.json());showResult(result);});function showResult(result){resultArea.classList.remove("hidden-element");resultArea.classList.add("shown-element");resultArea.innerHTML=`<h5>Pela tabela FIPE,seu veículo ${result.Marca}-${result.Modelo}-${result.AnoModelo},vale em média:</h5><h2>${result.Valor}</h2><h6>Consulta válida para ${result.MesReferencia}</h6><h6>Código FIPE:${result.CodigoFipe}</h6>`;loading=false;loadingControl();autoScroll();} function autoScroll(){const heightPage=document.body.scrollHeight;window.scrollTo(0,heightPage);} function loadingControl(){if(loading){loadingElement.classList.remove("hidden-element");loadingElement.classList.add("shown-element");}else{loadingElement.classList.remove("shown-element");loadingElement.classList.add("hidden-element");} autoScroll();}